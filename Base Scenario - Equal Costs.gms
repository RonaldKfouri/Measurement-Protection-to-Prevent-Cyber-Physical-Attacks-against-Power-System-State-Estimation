Sets
     m  meas    / z00*z29 /
     pi(m) /z00*z10 /
     pf(m) /z11*z25 /
     t(m)  /z26*z29 /
     i  index    / i00*i13 /
  Alias (i,i2);

Binary Variable w(m), y(m,i);
Free Variable z;

Table K(m,i)
          i00     i01     i02     i03     i04     i05     i06     i07     i08     i09     i10     i11     i12     i13
z00       1       1       0       0       1       0       0       0       0       0       0       0       0       0
z01       0       1       1       1       0       0       0       0       0       0       0       0       0       0
z02       1       1       0       1       1       1       0       0       0       0       0       0       0       0
z03       0       0       0       0       1       1       0       0       0       0       1       1       1       0
z04       0       0       0       1       0       0       1       1       1       0       0       0       0       0
z05       0       0       0       0       0       0       1       1       0       0       0       0       0       0
z06       0       0       0       0       0       0       0       0       1       1       1       0       0       0
z07       0       0       0       0       0       1       0       0       0       1       1       0       0       0
z08       0       0       0       0       0       1       0       0       0       0       0       1       1       0
z09       0       0       0       0       0       1       0       0       0       0       0       1       1       1
z10       0       0       0       0       0       0       0       0       1       0       0       0       1       1

z11       1       0       0       0       1       0       0       0       0       0       0       0       0       0
z12       0       1       1       0       0       0       0       0       0       0       0       0       0       0
z13       0       1       0       1       0       0       0       0       0       0       0       0       0       0
z14       0       0       1       1       0       0       0       0       0       0       0       0       0       0
z15       0       0       0       1       1       0       0       0       0       0       0       0       0       0
z16       0       0       0       1       0       0       1       0       0       0       0       0       0       0
z17       0       0       0       1       0       0       0       0       1       0       0       0       0       0
z18       0       0       0       0       1       1       0       0       0       0       0       0       0       0
z19       0       0       0       0       0       1       0       0       0       0       1       0       0       0
z20       0       0       0       0       0       1       0       0       0       0       0       1       0       0
z21       0       0       0       0       0       1       0       0       0       0       0       0       1       0
z22       0       0       0       0       0       0       1       1       0       0       0       0       0       0
z23       0       0       0       0       0       0       1       0       1       0       0       0       0       0
z24       0       0       0       0       0       0       0       0       0       0       0       1       1       0
z25       0       0       0       0       0       0       0       0       0       0       0       0       1       1

z26       1       0       0       0       0       0       0       0       0       0       0       0       0       0
z27       0       0       0       1       0       0       0       0       0       0       0       0       0       0
z28       0       0       0       0       0       1       0       0       0       0       0       0       0       0
z29       0       0       0       0       0       0       1       0       0       0       0       0       0       0;

Equations
Eq9(m,i),
Eq12(m),
Eq10(i),
Eq13(pi,i),
Eq14,
OF;

Eq9(m,i).. y(m,i) =E= y(m,i)*K(m,i);
Eq12(m).. sum(i,K(m,i)*y(m,i)) =E= w(m);
Eq10(i).. sum(m,y(m,i)) =G= 1;
Eq13(pi,i).. sum (pf, w(pf)*K(pf,i)) + w(pi) =L= sum (i2, K(pi,i2));
Eq14.. sum(t, w(t)) =G= 1;

OF.. sum(m,w(m)) =E= z;

Model Test / all / ;

Solve Test minimizing z using MIP;

Display w.L, y.L, z.L;
